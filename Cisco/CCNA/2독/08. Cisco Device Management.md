
## Router Configuration Files

Configuration files are typically located in one of three places:
RAM, NVRAM, and/or an external server, such as TFTP, FTP, HTTP, or SCP server.

The configuration that the router is currently using is in RAM.
You can back up or save this configuration either to NVRAM or to an external server.

The commands *related* to configuration files, even `show` commands, requires you to be working in privileged EXEC mode.
Also the running configuration of an IOS device is not automatically save to NVRAM, you must manually do this by issuing the `copy running-config startup-config` command.

### Saving Configuration Files

You can copy your running-config or startup-config configuration file to flash:
```
IOS# copy running-config flash:FILE_NAME
IOS# copy startup-config flash:FILE_NAME
```

You can also back up your configuration to an external server.
```
IOS# copy running-config URL_LOCATION

### example
IOS# copy running-config tftp://192.168.1.10/mybackupfile.txt
```

The configuration is backed up to an ASCII text file.
If you don't supply the full URL, just the protocol information, you'll be prompted for the additional information:
```
IOS# copy running-config tftp
Address or name of remote host []? 192.168.1.10
Destination filename [router-config]? mybackupfile.cfg
!!
781 bytes copied in 5.8 secs (1156 bytes/sec)
IOS#
```

If the filename already exists on the server *overwrites* the old file.
After entering this information, you should see bang symbols (!) indicating the successful transfer of UDP segments to the TFTP server.
if you see periods (.), this indicates an unsuccessful transfer.
Plus, upon a successful transfer, you should also see how many bytes were copied to the server.

### Restoring Configuration Files

There may be situations in which you have misconfigured your router or switch and want to reload a saved configuration file into your Cisco device.
You can do this by reversing the source and destination information in the `copy` command:

```
IOS# copy URL_LOCATION running-config
IOS# copy URL_LOCATION startup-config
```

You can use three variations of the `copy` command to restore your configuration.

```
IOS# copy tftp startup-config
IOS# copy flash:FILE_NAME running-config|startup-config
```

### Creating and Deleting Configuraiton Files

To create a basic configuration file by going into configuration mode with the privileged EXEC `configure terminal` command.
When you are executing commands within this mode (wheter by typing them or pasting them in), IOS is using a merge process (unless you use the `no` parameter for a command to delete or negate it).

You can also delete your configuration file in the startup-config file in NVRAM by using the following command:

```
IOS# erase startup-config
IOS# erase nvram
```

You can also use the `write erase` command to delete your startup configuration.

To verify the erasure, use the `show startup-config` command.
If the startup-config was erased, you will get the following message:
```
IOS# show startup-config
%% Non-volatile configuration memory is not present
```

### Configuration File Nomenclature

Starting with IOS 12.0 and later, Cisco introduced command and naming nomenclatures that follow Cisco IOS File System (IFS) guidelines (what you are used to when entering URL in a web browser address text box).
Therefore, instead of entering a command and having a router prompt you for additional information, such as the IP address of a TFTP server and the filename, you can now pull all of this information on a sinfle command line.

Commands that reference configuration files and IOS images contain prefixes in front of the file type.

**File locations**

| Location  | DESC                                                      |
| --------- | --------------------------------------------------------- |
| bootflash | Bootflash memory                                          |
| flash     | Flash memory on the motherboard                           |
| flh       | Flash load helper log files                               |
| ftp       | FTP server                                                |
| nvram     | Nonvolatile RAM (NVRAM)                                   |
| rcp       | Remote Copy Protocol (RCP) server                         |
| scp       | Secure Copy (SCP) server - uses RCP through an SSH tunnel |
| slot0     | PCMCIA slot 0                                             |
| slot1     | PCMCIA slot 1                                             |
| system    | RAM                                                       |
| tftp      | TFTP server                                               |

Suppose you want to back up your router's configuration from RAM to NVRAM.
With the new syntax, you could use:
```
IOS# copy system:running-config nvram:startup-config
```

You don't always have to include the type; for instance, instead of the preceding example, you could have used this:
```
IOS# copy running-config startup-config
```

In many cases, IOS knows, based on the name of the file, which location your're referring to.
For example, you you use running-config, IOS assuems you're referring to RAM, or system:, as the location.

To view the active configuration, you can use this command:
```
IOS#more system:running-config
```

If you want to delete a file in flash, such as a backed-up configuration file:

```
IOS# delete flash:FILE_NAME
```

> The older style of entering configuraiton and IOS commands is still supported along with the new one.
> The `write memory` command, which can be avvreviates as `wr`.
> This performs the equivalent of the `copy running-config startup-config` command, but it requires only two keystrokes to perform.

### Review of Configuration Files

It is important that you understand what action IOS will take when it is either backing up or restoring a configuraiton file to a particular location.

**Overview of IOS Process When Dealing with Configuration Files**

| From  | To    | Command                            | IOS Process |
| ----- | ----- | ---------------------------------- | ----------- |
| RAM   | NVRAM | copy running-config startup-config | Overwrite   |
| RAM   | TFTP  | copy running-config tftp           | Overwrite   |
| NVRAM | RAM   | copy startup-config running-config | Merge       |
| NVRAM | TFTP  | copy startup-config tftp           | Overwrite   |
| TFTP  | RAM   | copy tftp running-config           | Merge       |
| TFTP  | NVRAM | copy tftp startup-config           | Overwrite   |
| CLI   | RAM   | configure terminal                 | Merge       |

> Anything copied into RAM uses a merge process
> Other copy operation uses an overwrite process

### Exercise 8-1: Manipulating Your Router's Configuration Files

* look at your configuration viles
	* `show startup-config`
	* `show running-config`
* make change to your configuration
* save the change to NVRAM
	* `copy running--config startup-config`
	* `write`
	* `copy system:running-config nvram:startup-config`
* verify
	* `show startup-config`

---

## Changes in Your Network

When you decide to make changes to your network, including the addition or deletion of devices, you should always preparation work *before* you make the changes.

Making changes can cause thing to malfunction or not function at all, so you should always prepare beforehand.

### Adding Devices

Before you add an IOS device to you network, gather the following information and perform the following tasks:

1. Decide which IP address you'll assign to the device for management purposes.
2. Configure the ports of the device, including the console and virtual type terminal ports.
3. Set up your passwords for User and Privileged EXEC access
4. Assign the appropriate IP addresses to the device's interface(s)
5. Create a basic configuration on the device so that it can perform its job.

### Changing Devices

You will be constantly be making configuration changes to your network to enhance performace and security.

*Before* you make any changes to your network, you should *always* back up your configuration files.
Likewise, before you perform a software upgrade on your Cisco device, you should always back up the old IOS image.

You should check a few things before loading the new image on your IOS device.
Ask yourself the following before proceeding to load the new image:
First, does the new image contains all of the features that your previous image had? Or does it contain at least features you need?
Also, does your IOS device have enough flash and RAM to store and load the IOS image?

At times, you may need to upgrade hardware or add a new module to your device.
Some devices require that you turn them off before doing upgrade, while other devices can stay powered on.

> it is extremely important that you read the installation manual that comes with the hardware before performing an installation.
> If you install a hardware component into a device that requires that the device be turned off, and the device is running, you could damage your new component or, worse, electrocute yourself.

---

## IOS Image files

The default location of IOS images is in flash.
On some IOS device, flash is built into the motherboard, some use PCMCIA cards for stroage, and some use a combination of both.

At times, you will have to deal with the device's flash when you want to perform an upgrade, for instance.

To view your files in flash, use the `show flash` command.
In addition to using the `show flash` command, you can also use the `dir` command to see how much flash memory is avilable on your IOS device.

### Naming Conventions for IOS Images

Cisco has implemented a naming convention for its IOS images, which enables you to see the platform, software version, and features included in the image just by looking at the image filename.

As an example, consider the image name from the preceding `show flash` command, c1841-advipservicesk9-mz.124-6.T7.bin, which is from router.

* **c1841**
	* Refers the name of the platform on which the image will run.
	* This is important, because different router models have different processors, and an image compiled for one processor or router model will typically *not* run on a different model.
* **advipservicesk9**
	* Refers to the features included in this IOS version, commonly referred to as the *feature set*.
	* In this example, IOS is the advanced IP services
	* k9 refers to the inclusiotion of encryption support
* **mz or z**
	* Means that the image is compressed and must be uncompressed before loading/running.
	* If you see *l* here, this indicates where the IOS image is run from.
	* The *l* indicates that it is a relocatable image and the image can be run from RAM.
	* Remeber some images can run directly from flash, depending on the router model.
* **124-6.T7**
	* Inidicates the software version number of IOS.
	* In this instance, the version is 12.4(6)T7.
	* Image filenames with *T* indicate new features, and those without *T* indicate the mainline (only bug fixes are made to it).

### Before Upgrading the IOS Image

Before you upgrade the IOS on your device, you should first back up the existing image to an external server, for two reasons:
First, your flash may not be large enough to support two images (the old one and the new).
If you load the new one and you experience problems with it, you'll probably want to load the old image back onto your device.
Second, Cisco doesn't keep every software version available on its web site.
Older versions of IOS are hard to locate.

You can back up your Cisco IOS (and configuration file) to a TFTP server or to an FTP server.
Although both are File Transfer Protocols, they do differ in their underlining use.

TFTP uses UDP port 69 and does not require authentication (a username and password) to connect to the TFTP server.
FTP users TCP port 21 (command channel) and TCP port 20 (data channel) and does use authentication by having the person connecting supply a username and password that is configured on the server.

### Exercise 8-2: Installing TFTP Software

### Backing Up an IOS Image

There are multiple ways to back up your Cisco IOS and then eventually restore the IOS goes corrupt or needs replacing.
For example, you can back up to a TFTP server, an FTP server, or a USB drive.

```
VAN-R1#copy ?
  /erase          Erase destination file system.
  /error          Allow to copy error file.
  /noverify       Don't verify image signature before reload.
  /verify         Verify image signature before reload.
  archive:        Copy from archive: file system
  bootflash:      Copy from bootflash: file system
  cns:            Copy from cns: file system
  disk0:          Copy from disk0: file system
  disk1:          Copy from disk1: file system
  flash:          Copy from flash: file system
  ftp:            Copy from ftp: file system
  http:           Copy from http: file system
  https:          Copy from https: file system
  null:           Copy from null: file system
  nvram:          Copy from nvram: file system
  pram:           Copy from pram: file system
  rcp:            Copy from rcp: file system
  running-config  Copy from current system configuration
  scp:            Copy from scp: file system
  slot0:          Copy from slot0: file system
  slot1:          Copy from slot1: file system
  startup-config  Copy from startup configuration
  system:         Copy from system: file system
  tar:            Copy from tar: file system
  tftp:           Copy from tftp: file system
  tmpsys:         Copy from tmpsys: file system

VAN-R1#copy
```

#### Using a TFTP Server

To back up your IOS image, you'll use the `copy flash URL` command.

Optionally, you can speicify the filename of the IOS in the command line.
The URL specifies a URL-style syntax and includes the protocol such as TFTP, the IP address of the server, possibly the directory to put it in, and the name the image will be called on the server.

```
Router# copy flash tftp
Source filename []? c3640-js-mz.120-11
Address or name of remote host []? 192.168.1.10
Destination filename [c3640-js-mz.120-11]?
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
.
.
.
6754416 bytes copied in 64.452 secs (105537 bytes/sec)
```

As the image is backed up to the TFTP server, you should see a bunch of exclamation points filing up your screen. This indicates the successful copy of a packet.
If you see a sequence of periods instead, this indicates a failure.

After a successful copy operation, you should see the number of bytes cpoied as well as how long it took.

Compare the number of bytes copied to the file length in flash to verify that the copy was actually successful.

#### Using FTP

If you have an FTP server available, you can use that to back up your configuration files for your Cisco IOS.
The first step is to configure the Cisco device for the FTP username and password needed to authenticate to the target FTP server.

```
R1#config t
R1(config)#ip ftp username ftpuser
R1(config)#ip ftp username ftppass
R1(config)#end
R1#
```

Next, use the `copy` command and specify `ftp:` as the source or destination, depending on whether you are copying from the FTP server or copying to the FTP server, respectively.
It is important note that you can also copy the configuration of the device, or the Cisco IOS, when using the `copy` command.

**example of backing up the configuration of the device to the FTP server:**
```
R1#copy running-config ftp:
Address or name of remote host []? 192.168.2.25
Destination filename []? R1_backup_config
Writing R1_backup_config !
1015 bytes copied in 3.554 secs (244 bytes/sec)
```

As with TFTP, once the configuration is saved to the FTP server, you can restore the configuration to a replacement device at any time.
First, make sure you configure the FTP username and password as shown in the eariler code example. Then you copy the configuraiton to the new device by using the following commands:

```
NewRouter#copy ftp: running-config
```

These code examples are backing up the configuration to the FTP server, but if you wnated to back up the Cisco IOS to the FTP server, you would use the `copy flash: ftp:` command.

#### Using USB Storage

If your Cisco device has USB ports, you can back up the configuration or the Cisco IOS to the USB drive.

To back up your Cisco configuration to the USB drive, the the `copy current-config usbflash0:` command.

```
R1#dir usbflash0:
R1#copy usbflash0:R1_config current-config
```

If you want to copy your IOS to the USB drive, you can use the `copy` command as well:

```
R1#copy flash:c2900-universalk9-mz.SPA.151-4.M4.bin usbflash0:
```

It is useful to use the `dir flash:` or the `show flash` command first so that you can see a list of filenames that exists in flash memory.

### Upgrading an IOS Image

Before you upgrade IOS on your Cisco device, you first need to verify that your device meets the minimal hardware requirements by asking these questions:
* Does your router have the minimal amount of required RAM?
* Does your router have the minimal amount of required flash memory?

You can see the amount of installed RAM and flash with the `show version` command.
Also remember to verify that your IOS device has enough free flash memory to add the additional device (`show flash`, or `dir` command); if not, you'll need to delete unneeded files to make room for the new image.

If you wnat to upgrade your IOS to load a previously saved IOS image, you'll need to place the IOS image on an external server (such as TFTP or FTP) and use the `copy URL flash` command.
You'll prompted for the same information you needed when you used the `copy flash tftp` command; however, the process that takes place after you enter your information is different.
After you enter your information, IOS first verifies that the image exists on the TFTP server.
If the file exists on the server, IOS then asks you if you want to erase flash.
Answer `y` if you don't have enough space in flash for the older image(s) as well as the new one.
If you answer `y`, flash is erased and reporgrammed; as this step proceeds, you will see a line of e's on the screen.

After flash is initialized, your router pulls the IOS image form the TFTP server.
Just as in the copy operations with configuration files, a bunch of exclamtion marks indicates successful copies, while periods indicate unsuccessful copies.

If the router noticed that the name of the image that exist on the TFTP server is the same name that is in flash and verifies that you want to overwrite it.
Also, the router prompts you to erase flash (this is the default with IOS and will delete *all* files). Answer *n* if you don't want to completely erase flash.

After the router copies the IOS image to flash, you must reboot your router in order for it to use the new image.
However, by default, the Cisco device loads the first valid IOS image in flash.
To use a different one, you need to define this in your configuration with the `boot system` commands and save this as part of the startup configuration file.

The `boot system` commands are processed in order in the startup configuration file.
If there is one there that is no longer needed, you should remove it with the corresponding `no boot system` command, followed by the old IOS image name.

You can reboot your router in two ways: do a hard reboot by turnging the router off and back on, or do a soft reboot by using the `reload` command.

```
# boot off the IOS image c2900-universlk9-mz.SPA.151-4.M4.bin

boot system flash c2900-universalk9-mz.SPA.151-4.M4.bin
```

If you want, you can also boot your system from an IOS that is located on a TFTP server by using the `boot system ftfp <IOS_FILENAME>` command.
Keep in mind that the boot process will be much slower as the device has to read the IOS from across the network.

If you place an incorrect image on your router, the router will not boot up.
You'll need to break into ROM Monitor (ROMMON) mode and either do a TFTP boot or boot from the Mini IOS in ROM (if this exists).

> To copy from TFTP, use the `copy flash tftp://URL` command to back up the IOS image, and use the `copy tftp://URL flash` command to restore or upgrade the IOS.
> The `reload` command reboots the router.
> When doing an upgrade, if either the server is not reachable or you have misconfigured the IP address or filename, you'll get an error message within the CLI.

If you encounter a problem with accessing a remote server when performing the upgrade, you'll get an error message.
This could be because you configured the wrong IP address of the server in the `copy` command or you entered a nonexistent IOS image name.

#### Using tftpdnld

You can use the `tftpdnld` command option to load an IOS onto a Cisco device if an IOS is missing or corrupt.
This is used if an IOS is not booted and you have entered ROMMON mode.

To use `tftpdnld` you will need to have ROMMON loaded and you will need network connectivity to load an IOS via `tftpdnld`.
It is important to note two key points about the `tftpdnld` command option in ROMMON mode:

* It erases all filed that exit in flash memory before downloading the IOS image specified.
* The transfer happens over the first port on the device.

After booting to ROMMON mode, before you use the `tftpdnld` option, you must first configure a few of the environment variables that are used to perform the copy:

```
rommon 1> IP_ADDRESS=12.0.0.50
rommon 2> IP_SUBNET_MASK=255.0.0.0
rommon 3> DEAFULT_GATEWAY=12.0.0.1
rommon 4> TFTP_SERVER=12.0.0.100
rommon 5> TFTP_FILE=c2900-universalk9-mz.SPA.151-4.M4.bin
```

Once you have set the environment variables, you can then use the `tftpdnld` command from ROMMON to start the IOS downloaded from the TFTP server:

```
rommon 6> tftpdnld
	      IP_ADRESS: 12.0.0.50
	 IP_SUBNET_MASK: 255.0.0.0
	DEFAULT_GATEWAY: 12.0.0.1
	    TFTP_SERVER: 12.0.0.100
	      TFTP_FILE: c-2900-universalk9-mz.SPA.155-3.M4a.bin
Invoke this command for disaster recovery only.
WARNING: all existing data in all partitions on flash will be lost
Do you wish to continue? y/n: [n]: y
```

After the download is complete, you will see a ROMMON prompt.
You can use the `reset` command to reboot the Cisco device.

#### Using xmodem

To use the ROMMON `tftpdnld` command, you must have network connectivity, but when if your Cisco device is not loading an IOS and does not have network connectivity?
What you could do is boot the ROMMON prompt and then use the `xmodem` command, which will copy the Cisco IOS from the comptuer connected to the console port to your Cisco device using the console port.

To use the `xmodem` command, you'll need to have a terminal program that allows you send a file via Xmodem.

**use xmodem**
1. Boot your switch to ROMMON mode by unplugging the switch, holding down the mode button, and then plugging the power back into the switch. Hold the mode button until the device boots to the `switch:` prompt.
2. Launch terminal emulator and connect via Serical connection. Use the serial connection to connect to the COM port that is connected to the console port on your Cisco device.
3. If you are working on a Cisco switch, you may need to initialize flash memory by using:

```
Switch: flash_init
```

4. Once flash memory has been initialized, you can copy from the computer to flash memory

```
switch: copy xmodem: flash:c3750-ipbase-mz.122-35.SE5.bin
```

5. In terminal, send to file via xmodem
6. After the trasnfer has completed you can test the loading of the new IOS:

```
switch: boot flash:c3750-ipbase-mz.122-35.SE5.bin
```

> The default baud rate within Xmodem is 9600, but you can increase the baud rate within ROMMON using `set BAUD 57600`


### Exercise 8-3: Backing Up and Restoring Device Configuration and IOS

* Back up VAN-R1's device configuration to the TFTP server
* Restore it from the TFTP server.

```
### TFTP server available at the IP address 12.0.0.100

### Back up to tftp server
VAN-R1>enable
VAN-R1#copy running-config tftp
Address or name of remote host []? 12.0.0.100
Destination filename [VAN-R1-config]? VAN-R1-config

### Change some config
VAN-R1#config term
VAN-R1(config)#hostname Test
Test(config)# exit
Test#

### restore configuration from the tftp server
Test#copy tftp running-config
Address or name of remote host []? 12.0.0.100
Source filename []? VAN-R1-config
Destination filename [running-config]? <<ENTER>>
VAN-R1#
```

---

## Remote Access to Your Cisco Device

In many instances, it may not be possible to be physically in front of your IOS device to manage it.
You can optionally manage it remotely by accessing its CLI via telnet or SSH, or you can manage it with a GUI with a web browser.

To access your IOS device's CLI remotely, you must first set up its VTYs.
If you're accessing a layer 2 IOS switch, you'll need to assign an IP address to a VLAN interface; if you're accessing a router, you'll need to assign an IP address to one of its interfaces and enable it.

By default, only telnet is enabled on the router.

### SSH vs. Telnet Access

The problem with telnet, however, is that all information sent between you and the Cisco device is sent in clear test, including your username and/or password.

Since you don't want someone eavesdropping your connection and seeing everyting you do, you need to protect yourself by encrypting the traffic.

The easist way to accomplish this is to replace to use of telnet with SSH.
SSH uses RSA as an encryption algorithm to enctypt andy data sent between you and your networking device.

### Telnet Configuration

#### Configuring Telent

Before you can remote connect to the router using telnet, you need to ensure that an IP address is assigned to the device.
On a router, this will be an IP address on the interface, but for a Cisco switch, you will assign an iP address to the management VLAN (typically VLAN 1).

Note that if you are going to telnet into a switch from another network, you will need to set the default gateway setting on the switch so that the switch can send data off the network.

After configuring an IP address, you'll then configure VTY passwords and a password (or secret value) to enter privileged EXEC mode.
On a Cisco devcie, you cannot telnet into the device if those passwords are not set.

```
VAN-R1>enable
VAN-R1#config t
VAN-R1(config)#line VTY 0 15
VAN-R1(config-line)#password telnetpass
VAN-R1(config-line)#login
```

#### Using Telnet

If you've configured your Cisco devices correctly (with IP addressing and routing information and the appropriate commands on the VTYs), you should be able to telnet to them successfully.
However, you may need to test connectivity with SSH instead.
Cisco routers and switches support both incomming and outgoing telnet and SSH.
This assumes you have set up the VTYs and configured your IP addressing correctly.

```
IOS# name_of_the_destination | destination_IP_address

of

IOS telnet name_of_the_destination | destination_IP_address

or

IOS connect name_of_the_destination | destination_IP_address
```

> If you mistype a command name from the CLI, the IOS assumes you're trying to telnet into a system with that name and attempts to resolve the name to an IP address using the local host table, or a DNS server query.
> This freezes up the CLI until the query attempt times out.
> To stop this behaviour, use the `no ip domain-lookup` command.

#### Suspending Telnet Sessions

If you are using an IOS device and telnet to a remote destination, you may want go back to your IOS device.
One way of doing this is to exit the remote deivce; however, you may just want to go back to your source Cisco device , make a quick adjustment, and then return to the remote device. Logging off and back on to the remote device is a hassle in this instance.

Cisco, however, has solved this problem by allowing you to *suspend* a telent session, return to your original router or switch, do what you need to do, and then jump right back into your remote device. all without your having to log off and back on to the remote device.

To suspend a telnet session, press `CTRL-SHIFT-6`, `x` (hold down the CTRL, SHIFT, and 6 keys simultaneously, let go, and then press the x key).

On your source IOS, if you want to see the open telnet sessions that are currently suspended, use the `show sessions` command:

```
IOS# show sessions
Conn Host      Address   Byte  Idle  Conn Name
   1 10.1.1.1  10.1.1.1     0     1  10.1.1.1
*  2 10.1.1.2  10.1.1.2     0     2  10.1.1.2
```

This example shows two open telnet sessions.
The one with the asterisk (`*`) preceding it is the default (last accessed) session.
To resume the last session, all you have to do is press ENTER on an empty command line.

To resume a specific session:

```
Router# resume CONNECTION_#
```

The connection number to enter is the number in the Conn column of the `show sessions` command.
As a shortcut, you can just list the connection number without including resume; this will accomplish the same thing.

If you are on the source router or switch and want to terminate a suspend telnet session without having to resume and then log out of the telnet session, you can use this command:

```
Router# disconnect CONNECTION_#
```

#### Verifying and Clearing Connections

If you are logged into the IOS device, you can view other users who are also logged in with this command:

```
Router#show users
  Line          User    Host(s)    Idle    Location
  0    con 0                       idle
  2    vty 0            idle          0    10.1.1.1
* 3    vty 1            idle          0    10.1.1.2
```

The asterisk in the first column indicates the current session.

If you want to terminate someone's session, use the privileged EXEC `clear line` command:

```
Router#clear line LINE_#
```

The line number that you enter here should match the appropriate number in the Line column of the `show users` command.

### Exercise 8-4: Configuring Telnet on the Cisco Device

* Configure VAN-R1 router
* configure telent

```
VAN-R1#config term
VAN-R1(config)#enable password enablepass
VAN-R1(config)#enable secret secretpass
VAN-R1(config)#line vty 0 15
VAN-R1(config-line)#password telnetpass
VAN-R1(config-line)#login
```

### SSH Configuration

To set up SSH on your Cisco device so that you can use an SSH client to access it, you'll need to configure the following:

* **A local username and password**
	* SSh requires both a username and password configured on the device
	* `username` command configures both
* **A hostname and a domain name**
	* Hostname and domain name are required to label the RSA key pair on the IOS device
	* `hostname`, `ip domain-name`
* **The SSH version to use**
	* You should configure the specific SSH version you want to use.
	* The default is version 1, but the recommended version to use is 2
	* `ip ssh version`
* **RSA public and private keys**
	* You will need to generate the encryption keys.
	* These are used to encrypt and decrypt data that travels through the remote-access connection
	* `crypto key generate rsa`
* **Restricting VTY access**
	* You will ensure that remote access can be eachieved only through SSH and not telnet, because telnet does not encrypt communication.
	* By default, telnet is allowed on the VTYs
	* `login local`, `trasnport input`

```
VAN-R1#config t
Enter configuration commands, one per line.  End with CNTL/Z.
VAN-R1(config)#username joe secret mypassword
VAN-R1(config)#ip domain-name joe.com
VAN-R1(config)#ip ssh version 2
Please create RSA keys to enable SSH (and of atleast 768 bits for SSH v2).
VAN-R1(config)#line vty 0 15
VAN-R1(config-line)#login local
VAN-R1(config-line)#transpor
VAN-R1(config-line)#transport input ssh
VAN-R1(config-line)#exit
VAN-R1(config)#crypto key generate rsa
The name for the keys will be: VAN-R1.joe.com
Choose the size of the key modulus in the range of 360 to 4096 for your
  General Purpose Keys. Choosing a key modulus greater than 512 may take
  a few minutes.

How many bits in the modulus [512]: 1024
% Generating 1024 bit RSA keys, keys will be non-exportable...
[OK] (elapsed time was 1 seconds)

VAN-R1(config)#
*Oct 12 00:09:16.254: %SSH-5-ENABLED: SSH 2.0 has been enabled
VAN-R1(config)#
```

When you execute the `crypto key generate rsa` command, you are prompted for the length of the RSA keys.
The longer the keys, the more secure your connection will be, with 2048-bit keys being the strongest.

Chossing a higer value, however, will take longer for the IOS device to generate.
On IOS device shipped today, this shouldn't take that long.

Another item to point out about this configuration is the two commands on the VTYs.
The `login local` command specifies the use of the local database (`username` command) for authentication; this causes the IOS device to prompt for both a username *and* password for authentication.

Without *local* parameter, the IOS device prompts only for a password, using the `password` command on the line to do the authentication.
SSH requires the use of both username and passwords.

The `transport input ssh` command restricts access to the VTY to SSH use only; by default, all forms of remote access, including telnet, are allowed.

---

## Configuration Registers and Password Recovery

One of the common tasks that you will be required to perform in the real world, and on the Cisco exams, is password recovery.
You'll use password and need to bypass the password so you can administer the device and reset the password.

### Configuraiton Registers

The *configuration register* setting is used by the bootstrap program to determine the location from which the IOS image and configuration file should be loaded.

The configuration register is a 16-bit field taht is stored in NVRAM and can be modified to control how your device boots.

For example, if you forgot your password on your Cisco device, you can modify the configuration register not to load the startup configuration at bootup in order to bypass the password.

![[Pasted image 20251012001742.png]]

The 16 bits are divided into four, 4-bit blocks, with each 4-bit chunk known as a *nibble*. (8-bit: byte)

Note that the values of the 4 bits in a nibble start on the right side as 1, then 2, then 4, and finally 8.
Those values repeat for each of the four nibble that exist in the 16-bit register fields.

Turning on one of the bits in the configuration registers is a method to enable a feature during bootup.
For example, if bit number 6 is turned on, the contents of NVRAM are ignored and not applied during bootup.

**Some of the common bits in the configuration registers**

| Bit Number | Explanation                                          |
| ---------- | ---------------------------------------------------- |
| 0-3        | Known as the boot fields discussed in next section   |
| 6          | Ignore the contents of NVRAM                         |
| 7          | Disable the display of boot messages                 |
| 8          | Break is disabled                                    |
| 10         | IP broadcast with all zeros                          |
| 13         | Loads the default ROM software if network boot fails |

For example, if you wanted to boot the device and have it load the IOS and the statup configuration, you would set the configuration register value to 0x2012 (the default setting).
But if you wanted to restart the Cisco device and have it load the IOS, but not the startup configuration, you would set the configuration register to 0x2142 (which enables bit 13, bit 8, bit 6 and bit 1)

2102: 0010 0001 0000 0010
2142: 0010 0001 0100 0010

#### Boot Fields

The first 4-bit nibble on the right side is known as the *boot field*, which controls how the Cisco device boots up.
If the boot field equals a specific decimal value, then the bootup of the device happens a specific way.

* **0**
	* If the boot field equals 0 (no bits enabled), the Cisco device will boot the ROMMON mode.
	* This boot mode is typically used when troubleshooting startup issues or needing to download or install a new IOS image file.
	* When booted to ROMMON mode, the configuraiton register value would be 2100.
* **1**
	* If the boot field has a decimal value of 1, the device boots to a Mini IOS that is located on ROM and known as RXBOOT.
	* When a device is booted into RXBOOT, the prompt is router (boot)>.
	* The configuration register in this case would be set to 2101.
* **2 to F**
	* Having the boot field set to a value from 2 to F indicates the IOS image that should be loaded from flash memory.
	* To boot an IOS image from flash memory, the configuration register would have a value of 2102 through 210F.

#### Looking at the Configuration Register Value

Once the router is booted up, you can view the current configuration register value with the `show version` command:

```
VAN-R1#show version
Cisco IOS Software, 7200 Software (C7200-ADVENTERPRISEK9-M), Version 15.3(3)XB12, RELEASE SOFTWARE (fc2)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2013 by Cisco Systems, Inc.
Compiled Tue 19-Nov-13 04:39 by prod_rel_team

ROM: ROMMON Emulation Microcode
BOOTLDR: 7200 Software (C7200-ADVENTERPRISEK9-M), Version 15.3(3)XB12, RELEASE SOFTWARE (fc2)

VAN-R1 uptime is 1 day, 43 minutes

....

Configuration register is 0x2102
```

At the very bottom of the `show version` output, the current value of the configuration register is shown.

#### Changing the Configuration Register from Configuration Mode

You can change the configuration register value from configuration mode or from ROMMON mode.

```
Rotuer(config)# config-register 0xHEX_VALUE
```

> If you configured your router, rebooted it, and it came up with the System Configuraiton dialog prompt, then you either forgot to save your running configuration before rebooting or misconfigured the configuration register.

The register value is four hexadecimal degits, or 16 bits in length.
Each bit position in the register, though, indicates a function that the bootstrap program should take.
Therefore, you should be very careful when configuring this value on your router.

When entering the register value, you must always precede it with *0x*, indicating the this is a hexadecimal value.
If you don't do this, the router assumes the value is decimal and *converts* it to hexadecimal.
On Cisco routers, the default configufation value is *0x2102*, which causes the router to use the default bootup process in finding and locating IOS images and configuration files.
If you change this to 0x2142, this tells the bootstrap program that, upon the next reboot, it should locate IOS using the default behaviour, but is should *not* load the configuration file in NVRAM; instead, you are taken directly into the System configuraiton dialog.
This is value that you will use to perform the password recovery procedure.

> Default configuration register value is 0x2102, which causes a router to boot up using its default bootup process.
> You can see the configuration register value with the `show version` command.
> If you've changed this value, you will see the existing value and the value the router will use upon rebooting.
> If the router boots up and doesn't have a configuration, but one exists in NVRAM, check the router's configuration register to see if it is set to 0x2142: this register setting causes IOS to ignore any configuration file in NVRAM when booting.

#### Changing the Configuration Register from ROM Monitor

One problem with the configuration mode method of changing the register value is that you must gain access to Privileged EXEC mode first.
This can be a problem if you don't know the passwords on the router.

A second method, though, enables you to change the register value without having to log into the router.
To use this method, you'll need console access to the router (you can't do this from the auxiliary line or from VTY session).
Next, you'll turn off the router and then turn it back on.
As the router starts booting, you'll break into ROMMON mode with the router's break sequence.
To break into the router, once you see the bootstrap program has loaded, you can in most cases, use the `CTRL-BREAK` control sequence to break into ROMMON mode.
Note that this control sequence may differ, depending on the terminal emulcation program you are using on your PC.

Once you're in ROMMON mode, you can begin the process of changing the register value using one of two methods, depending on the router model you have.
Cisco devices typically use the `confreg` command to modify the configuration register from ROMMON. You can use the command by following it with the value you want to change the configuraiton register to:

```
rommon 4 > confreg 0x2142
```

Or you can use it in script mode, where it prompts you about how you want to set the setting.
This script asks you basic questions about the function and bootup process of the router.

What's nice about the script is that you don't need to know the hexadecimal values for the configuration register, since the router will create them for you as you answer these questions.

```
rommon 5 > confreg
    Configuration Summary
enableds are:
load rom after reboot fails
console baud: 9600
boot: image specified by the boot system commands
      or default to: cisco2-C3600
      
do you wish to change the configuration? y/n [n]: y
enable  "diagnostic mode"? y/n [n]:
enable  "use net in IP bcast address"? y/n [n]:
disable "load rom after netboot fails"? y/n [n]:
enable  "use all zero broadcast"? y/n [n]:
enable  "break/abort has effect"? y/n [n]:
enable  "ignore system config info"? y/n [n]:
change console baud rate? y/n [n]:
change the boot characteristics? y/n [n]:

    Configuration Summary eanbled are:
load rom after netboot fails
console baud: 9600
boot: image specified by the boot system commands
      or default to: cisco2-C3600
do you wish to change the configuration? y/n [n]: n
rommon 6 >
```

Just as in the System Configuration dialog, any information in brackets ([]) represents default values.

The first question you're asked is whether you want to change the configuration, which means change the register: answer y to continue.
If you answer y to Ignore System Config Info?, the thrid hexadecimal digit becomes 4, making a router's register value appear as 0x2142.
This opetion is used when you want to perform the password recovery procedure.

For the next-to-last question, Change The Boot Characteristics?, if you answer y, it will repeat the questions again.
Answer n to exit the script.

If you make any changes, you are asked to save them (Do You Wish To Change The Configuration?) answer y to save your new register value.
Once you are done changing the register, reboot the router.

On many routers, just type `i` or `b` in ROMMON mode to boot it up.

### Password Recovery

One of the times you may want to maipulate the configuration register is when you have forgotten the password for your Cisco device and need to bypass the password to be able to administer the device.

The passwords are stored in your startup configuration which is stored in NVRAM.
To bypass the password you need to modify the configuration registers so that your device boots without loading the startup configuration (ignore NVRAM).
Once the device has booted without your startup confgiruation, you will be able to gain access without a password and can then set the password to a new value.

To configure your Cisco device to ignore NVRAM, you will need to enable bit 6, which has a value of 4, resulting in the configuraiton register value 0x2142 instead of the default 0x2102.

Following are the steps to recover the password on your Cisco device:

1. Use the `show version` command to view the current configuration register value.
2. When you power on the Cisco reouter, press `CTRL-BREAK` to distrup the boot process and go into ROMMON mode.
3. Type the following command to configure the device to skip startup config whne booting:
```
rommon>confreg 0x2142
```
4. Reboot the router with the `reset` command.
5. When the router reboots, it will not load the startup configuration and ask if you want to use the System Configuration dialog. Type `No` and press `ENTER`.
6. At the `router>` prompt, enter the `enable` command to get into privileged EXEC mode. Notice you are not asked for a password.
7. Use the `copy startup-config running-config` command to copy the startup configuration that was not read during bootup to be your current configuration. This is so you do not lose any settings.
8. View the configuration with the `show running-config` command.
9. Change the password by using the `enable password <NEW_PASS>` or `enable secret <NEW_SECRET>` command. You can also remove the password by using the `no enable password` or `no enable secret` command.
10. Copy that from your current configuration to your startup configuration by using the `copy running-config startup-config` command (or use the `write` command).
11. Use the `config-register 0x2102` command to change the configuration registers backto the default value of 0x2102 so that NVRAM is read during bootup.
12. Reboot the router with `reload` command.

### Exercise 8-5: Using the Password Recovery Procedure

* Change VAN-R1 router's password and secret

```
### Check value
VAN-R1#show version

### reboot & enter the ROMMON mode
rommon>

### skip startup config
rommon>confreg 0x2142

### reboot
rommon>reset

### save
Router>enable
Router#copy startup-config running-config

### verify config
Router#show running-config

### password change
Router#enable password labpass
Router#enable secret labsecret
Router#copy running-config startup-config

### change the configuration registers
Router#config-register 0x2102

### reboot
Router#reload
```

---

## Troubleshooting and Debugging

One of your first troubleshooting tasks is to determine in which layer of the OSI reference model things are not working.
By narrowing down the problem to specific layer, you can greatly reduce the amount of time you'll need to fix problem or problems.

When you're troubleshooting problems from a user desktop, Cisco always recommends that you start at the loweset layer and work your way up.

1. Verify the Ethernet cable connection
2. Verify the opertaion of the NIC (`ipconfig`)
3. Verify the IP configuration of the NIC (`ipconfig`)
4. Verify the application information.

Cisco offers a wide variety of troubleshooting tools that you can also use.

**Common IOS commands**

| OSI        | Command            |
| ---------- | ------------------ |
| Layer 2    | show ip arp        |
| Layer 2    | show interfaces    |
| Layer 2    | show cdp neighbors |
| Layer 3    | ping               |
| Layer 3    | traceroute         |
| Layer 7    | telnet             |
| Layers 2-7 | debug              |

### Local ARP Table

Address Resolution Protocol (ARP) is used to resolve layer 3 IP addresses to layer 2 MAC addresses.
When a LAN device in a subnet needs to access resources beyond the subnet, it must forward its frame to the MAC address of the default gateway (rotuer) and use ARP for the resoultion.

The router builds a local ARP table when it receives traffic on an interface, keeping track of the IP-to-MAC address mappings.
You can view the mapping using the `show arp` or `show ip arp` command:

```
VAN-R1#show ip arp
Protocol  Address          Age (min)  Hardware Addr   Type   Interface
Internet  12.0.0.1                -   ca01.01ec.0038  ARPA   FastEthernet2/0
Internet  172.30.1.1              1   54e1.ad08.d3c1  ARPA   GigabitEthernet0/0
Internet  172.30.1.2              2   8c3b.4a56.0786  ARPA   GigabitEthernet0/0
Internet  172.30.1.3              1   fad0.c8ab.9f30  ARPA   GigabitEthernet0/0
Internet  172.30.1.90             -   ca01.01ec.0008  ARPA   GigabitEthernet0/0
Internet  172.30.1.254            0   085d.dd37.cb2a  ARPA   GigabitEthernet0/0
```

A dash (-) in the (min) column means the address is loacl to the router; a time value indicates that the router learned the IP/MAC addressing mapping dynamically.

If a particular MAC address isn't shwon for a period of time, it is aged out of the ARP table.
Likewise, when a frame matches an existing entry in the table, its aging time is rest to 0 in the table.
The type colum denotes the Ethernet encapsulation type (ARPA, SNAP, or SAP) used in the frame: TCP/IP uses ARPA for Ethernet.

The `show ip arp` command is important, because if you see at least the router's own mappings in the table for its interfaces, and you see that entries are being learned and updated in the table, then you know you have layer 2 connectivity on those interfaces.

### Cisco Discovery Protocol

Cisco Discovery Protocol (CDP) is a Cisco proprietary data link layer protocol that was made aavailable in verison 10.3 of the router IOS.

Many but not all, Cisco devices support CDP, including Cisco routers and Catalyst switches.
For those devices that support CDP, it is enabled by default. CDP messages received from one Cisco device, by default are not forwarded to any other devices behind it.
In other words, you can see CDP information about *only* other Cisco devices directly connected to your device.

#### CDP Information

Since CDP uses a Subnetwork Access Protocol (SNAP) frame type, not every data link layer media type is supported.
The media types that are supported are Ethernet, Token Ring, Fiber Distributed Data Interface (FDDI), Point-to-Point Protocol (PPP), High-level Data Link Control (HDLC), Asynchronous Transfer Mode (ATM), and frame Relay.

The information shared in a CDP packet about a Cisco device includes the following:

* Name of the device configured with the `hostname` command
* IOS software version
* Hardware capabilities, such as routing, switching, and/or bridging
* Hardware platform of your device
* The layer 3 address(es) of the device
* The interface on which the CDP update was generated

#### CDP Configuration

CDP is enabled on all Cisco CDP-capable devices when you receive your product from Cisco.
On Cisco routers and switches, you can globally disable or enable CDP:
```
IOS(config)# [no] cdp run
```

You can also enable or disable CDP on interface-by-interface basis:
```
IOS(config)# interface INTERFACE_TYPE
IOS(config-if)# [no] cdp enable
```

Since CDP doesn't use many IOS resources, it is recommended that you keep it enabled unless your router is connected to the Internet  or untrusted devices; then you sould at least disable CDP on these interfaces.

At a minimum, the information is only 80 bytes in length.

#### CDP Status

```
VAN-R1#show cdp
Global CDP information:
        Sending CDP packets every 60 seconds
        Sending a holdtime value of 180 seconds
        Sending CDPv2 advertisements is  enabled
VAN-R1#
```

CDP is enabled and generating updates every 60 seconds.
The hold-down timer is set to 180 seconds. This timer determines how long a CDP neighbor's information is kept in the local CDP table without seeing a CDP update from that neighbor.

You can also see the CDP configuration on an interface-by-interface basis by adding the `interface` parameter to the `show cdp` command:

```
VAN-R1#show cdp interface
Ethernet0/0 is administratively down, line protocol is down
  Encapsulation ARPA
  Sending CDP packets every 60 seconds
  Holdtime is 180 seconds
GigabitEthernet0/0 is up, line protocol is up
  Encapsulation ARPA
  Sending CDP packets every 60 seconds
  Holdtime is 180 seconds
Serial1/0 is up, line protocol is up
  Encapsulation HDLC
  Sending CDP packets every 60 seconds
  Holdtime is 180 seconds
Serial1/1 is administratively down, line protocol is down
  Encapsulation HDLC
  Sending CDP packets every 60 seconds
  Holdtime is 180 seconds
Serial1/2 is administratively down, line protocol is down
  Encapsulation HDLC
  Sending CDP packets every 60 seconds
  Holdtime is 180 seconds
Serial1/3 is administratively down, line protocol is down
  Encapsulation HDLC
  Sending CDP packets every 60 seconds
  Holdtime is 180 seconds
FastEthernet2/0 is up, line protocol is up
  Encapsulation ARPA
  Sending CDP packets every 60 seconds
  Holdtime is 180 seconds
FastEthernet2/1 is administratively down, line protocol is down
  Encapsulation ARPA
  Sending CDP packets every 60 seconds
  Holdtime is 180 seconds
GigabitEthernet3/0 is administratively down, line protocol is down
  Encapsulation ARPA
  Sending CDP packets every 60 seconds
  Holdtime is 180 seconds
```

#### CDP Neighbors

To see a summarized list of the CDP neighbors to which your Cisco device is connected, use the `show cdp neighbors` command:

```
VAN-R1#show cdp neighbors
Capability Codes: R - Router, T - Trans Bridge, B - Source Route Bridge
                  S - Switch, H - Host, I - IGMP, r - Repeater, P - Phone,
                  D - Remote, C - CVTA, M - Two-port Mac Relay

Device ID        Local Intrfce     Holdtme    Capability  Platform  Port ID
LA-R1            Ser 1/0           159              R B   7206VXR   Ser 1/0
VAN-R1#
```

In this example, one device is connected with a device ID of *LA-R1*, which is 7206VXR router.
If you see a MAC address for the device ID, this indicates that the connected Cisco device wasn't assigned a name with the `hostname` command.
This update was received on serial 1/0 on this device 21 seconds ago (hold-down time: 180sec, holdtime: 159sec, 180-159).

The port ID refers to the port at the remote side from which the device advertised the CDP message.

You can add the optional `detail` parameter to the preceding command to see the details concerning the connected Cisco device.
You can also use the `show cdp entry *` command.

```
### show cdp neighbor detail
VAN-R1#show cdp neighbor detail
-------------------------
Device ID: LA-R1
Entry address(es):
  IP address: 13.0.0.2
Platform: Cisco 7206VXR,  Capabilities: Router Source-Route-Bridge
Interface: Serial1/0,  Port ID (outgoing port): Serial1/0
Holdtime : 159 sec

Version :
Cisco IOS Software, 7200 Software (C7200-ADVENTERPRISEK9-M), Version 15.3(3)XB12, RELEASE SOFTWARE (fc2)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2013 by Cisco Systems, Inc.
Compiled Tue 19-Nov-13 04:39 by prod_rel_team

advertisement version: 2
Management address(es):
  IP address: 13.0.0.2

#### show cdp entry *
VAN-R1#show cdp entry LA-R1
-------------------------
Device ID: LA-R1
Entry address(es):
  IP address: 13.0.0.2
Platform: Cisco 7206VXR,  Capabilities: Router Source-Route-Bridge
Interface: Serial1/0,  Port ID (outgoing port): Serial1/0
Holdtime : 131 sec

Version :
Cisco IOS Software, 7200 Software (C7200-ADVENTERPRISEK9-M), Version 15.3(3)XB12, RELEASE SOFTWARE (fc2)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2013 by Cisco Systems, Inc.
Compiled Tue 19-Nov-13 04:39 by prod_rel_team

advertisement version: 2
Management address(es):
  IP address: 13.0.0.2

VAN-R1#
```

In this example, you can see that the connected device is 7206 series router runing IOS 15.3(3)XB12 and has an IP address of 13.0.0.2 configured on the connected interface.

IOS devices support one additional CDP command, which enables you to view CDP traffic statistics:

```
VAN-R1#show cdp traffic
CDP counters :
        Total packets output: 10383, Input: 4599
        Hdr syntax: 0, Chksum error: 0, Encaps failed: 0
        No memory: 0, Invalid packet: 0,
        CDP version 1 advertisements output: 0, Input: 0
        CDP version 2 advertisements output: 10383, Input: 4599
VAN-R1#
```

If you are receiving CDP traffic (the `input` parameter is incrementing with each execution of the command every minute), then the data link layer is functioning correctly.

### Using LLDP

One of the drawbacks of CDP is that is a Cisco proprietary protocol.
If you had a mixed environment of Cisco devices and non-Cisco devices, CDP would not be able to discover the non-Cisco devices for you.

The IEEE has created an industry-standard protocol for device discovery, the Link Layer Discover Protocol (LLDP), which is known as the IEEE 802.1ab standard.

With LLDP running on your Cisco devices, you can use it to discover any other devices running LLDP, much like CDP.
LLDP is not enabled on Cisco device by default, but it can be enabled with the following command:
```
Router(config)#lldp run
```

Once enabled, LLDP is enabled for all interfaces.
you can disable LLDP with the `no lldp run` command.

If you wanted to disable LLDP on a specific interface, you can navigate to the interface and disable transmitting and receiving of LLDP on the interface:

```
Router(config-if)#no lldp transmit
Router(config-if)#no lldp receive
```

You can enable LLDP communication on the interface by using the `lldp transmit` command and the `lldp receive` command.

LLDP traffic is enabled both transmit and receive on all interfaces by default after you enable LLDP with the `lldp run` command.

You can verify that LLDP is running on your Cisco device by using the `show lldp` command.

### Layer 3 Connectivity Testing

CDP can be very useful in determining whether the data link layer is working correctly with another directly connected Cisco device, or it is commonly used to create a network map by discovering the different devices on the network.
You can even see the layer 3 addresses configured on your neighboring device and use this for testing layer 3 connectivity.
In addition to using CDP, you could also use the `show interfaces` command for data link layer testing.

The main limitation of these two tools, however, is that they don't test layer 3 problems, though Cisco does offer tools for testing layer 3 connectivity.

#### Using Ping

Ping (Packet Internet Groper) is a command utility that you can use to verify layer 3 connectivity on a Cisco device.
Ping uses ICMP as the status reporting protocols to identify whether or not a system is up and running.

You can use the `ping` command on your Cisco device by typing `ping <IP_ADDR>`.

Users can use the `ping` command from their machine to check for connectivty as well.

**Couple of messages that indicate problems and possible reasons**

* **Destination host unreachable**
	* The router connected to the remote host cannot contact that host on the connected segment.
* **Destination network unreachable**
	* A router between the source and destination dosen't have a routing table entry that determines how to reach the destination.

When using the `ping` command to perform the communication test, if the destination is reachable, the destination responds with an echo reply message for each echo sent by source.

If the destination is not reachable, an intermediate router, if it exists, will respond with a *destination network unreachable* message, indicating where the problem begins.
If a router is connected to the remote segment where the destination host is connected, and that router can't reach the destination host, this will cause a *destination host unreachable* message.

Also not that you may not receive a reply if ICMP is being blocked by a firewall.

#### Simple `ping` command

To execute a simpe `ping`:

```
LA-R1#ping 13.0.0.1
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 13.0.0.1, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 8/15/24 ms
LA-R1#
```

In this example, five test packets were sent to the destination and the destination responded to all five, as is shown by the exclamation marks (!).

The default timeout to receive a response from the destination is 2 seconds.
If a reponse is not received from the destination for a packet within this time period, a period (.) is displayed.

**Output Codes for the `ping` commands**
* **.**
	* A response was not received before the timeout period expired.
* **!**
	* A response was received within the timeout period.
* **U**
	* A remote router responded that the destination is unreachable
	* the network segment is reachable, but not the host.
* **N**
	* A remote router responded that the network is unreachable
	* The network cannot found in the routing table.
* **P**
	* A remote device responded that the protocol is not supported.
* **Q**
	* The source quench tells the source to slow its output.
* **M**
	* The ping packet needed to be fragmented, but a remote router couldn't perform fragmentation.
* **A**
	* The ping packet was filltered by a device with an access control list (administratively prohibited).
* **?**
	* The ping packet type is not understood by a remote device
* **&**
	* The ping exceeded the maximum number of hops supported by the routing protocol.

#### Extended ping Command

IOS devices support an extended `ping` command, which can be executed only at Privileged EXEC mode.

To execute this command, just type `ping` by itself on the command line:

```
LA-R1#ping
Protocol [ip]:
Target IP address: 13.0.0.1
Repeat count [5]:
Datagram size [100]:
Timeout in seconds [2]:
Extended commands [n]: y
Source address or interface:
Type of service [0]:
Set DF bit in IP header? [no]:
Validate reply data? [no]:
Data pattern [0xABCD]:
Loose, Strict, Record, Timestamp, Verbose[none]:
Sweep range of sizes [n]:
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 13.0.0.1, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 8/13/20 ms
LA-R1#
```

* **Protocol**
	* The protocol to use for the ping (defaults to IP)
* **Target IP address**
	* The IP address or hostname of the destination to test.
* **Repeat count**
	* How many echo requests should be generated for the test
	* defaults to 5
* **Datagram size**
	* The size, in bytes, of the ping packet
	* defaults to 100
* **Timeout in seconds**
	* The amount of time to wait before indicating a timeout for the echo
	* defaults to 2 seconds.
	* When seeing a mix of of periods and explanation points in the displayed output, incresing thie value can help determine whether you are exeriencing congestion problems with a slow reponse time between your IOS device and the destination.
* **Extended commands**
	* Whether or not the remaining questions should also be asked
	* defaults to no
* **Source address**
	* The IP address that should appear as the source address in the IP header
	* defaults to the IP address of the interface the ping will use to exist the IOS device.
* **Type of service**
	* The IP level for QoS
	* defaults to 0
* **Set DF bit in in IP header?**
	* Whether or not the ping can be fragmented when it reaches a segment that supports a smaller MTU size (the default is no).
	* Sometimes a misconfigured MTU can cause performace problems. You can use this parameter to pinpoint the problem, since a device with a smaller MTU size will not be able to handle the larger packet.
* **Data pattern**
	* The data pattern that is placed in the ping.
	* It is a hexadecimal four-digit (16-bit) number
	* defaults to 0xABCD
	* Used to solve cable problems and crosstalk on cables.
* **Loose, Strict, Record, Timestamp, Verbose**
	* IP header options
	* defaults to none of these
	* The record parameter records the route that the ping took (somewhat similar to traceroute)
	* If you choose record, you will be asked for the maximum number of hops that allowed to be recorded by the ping (defaults to 9, and can range from 1 to 9)
* **Sweep range of sizes**
	* Send pings that very in size.
	* This is helpful when trying to troubleshoot a problem related to a segment that has a small MTU size (and you don't know what that number is).
	* This defaults to n for no.

> When troubleshooting PC problems, first determine whether user can ping the loopback address of their PC: ping 127.0.0.1, If this fails, you know something is wrong with the TCP/IP protocol stack installation on the PC.
> Next, have the user try to ping the configured IP address. If this fails, you know that someting is wrong with their IP address configuration.
> Next, have the user ping the default gateway. If this fails, either something is wrong with the configured default gateway address, the default gateway itself, the subent mask value configured on the user's PC, or the layer 2 switch connecting them together (perhaps a mismatch in the VLAN on the router and PC interfaces of the switch).

#### Using Traceroute

One limitation of `ping` is that is will not tell you where, between you and the destination, layer 3 connectivity is broken.

The `traceroute` command, on the other hand, will list each router along the way, including the final destination.
Therefore, if a layer 3 connection problem exist, `traceroute` will tell you at least where the problem begins.

Like `ping` command, `traceroute` has two versions: one for user EXEC mode and one for privileged EXEC mode.

#### Simple traceroute command

```
Router> traceroute DEST_IP_ADDR
```

```
LA-R1#traceroute 1.1.1.1
Type escape sequence to abort.
Tracing the route to 1.1.1.1
VRF info: (vrf in name/id, vrf out name/id)
  1 13.0.0.1 8 msec 20 msec 12 msec
  2 172.30.1.254 40 msec 44 msec 20 msec
  3  *
    175.215.255.254 24 msec 16 msec
  4 112.174.185.93 24 msec 32 msec *
  5  *  *  *
  6  *  *  *
  7  *  *  *
  8 218.145.42.210 44 msec 56 msec 52 msec
  9  *
    141.101.82.17 20 msec *
 10 1.1.1.1 48 msec 32 msec 28 msec
LA-R1#
```

**Traceroute Messages**
* **`*`**
	* Either the wait timer expired while waiting for a response or the device did not respond at all potentially because of a firewall blocking ICMP traffic.
* **`A`**
	* The track packet was filtered by a remote device (administratively prohibited).
* **`U`**
	* The port of the device is unreachable
	* The destination received the trace packet but discard it.
* **`H`**
	* The destination is unreachable
	* The destination segment was reachable, but not the host
* **`I`**
	* The user interrupted the traceroute process.
* **`N`**
	* The network is unreachable
	* The destination segment was not reachable
* **`P`**
	* The protocol is unreachagle
	* The device doesn't support traceroute
* **`Q`**
	* The source quench tells the source to slow its output
* **`T`**
	* The trace packet exceeded the configured timeout value
* **`?`**
	* The device coundn't identify the specific trace types in the trace packet.

In certain cases, for a specific destination, you might see three asterisks (`***`) in the output.
Don't be alarmed if you see this, since it can occur for a variety of reasons: for instance, there may be an inconsistency in how the source and destination devices have implemented traceroute, or the destination may be configured not to reply to these messages.

However, if you continually find the same destination repeeated in the output with these reply messages, this indicates a layer 3 problem starting with either this device or the device preceding it.

#### Extended traceroute Command

```
LA-R1#traceroute
Protocol [ip]:
Target IP address: 1.1.1.1
Source address:
Numeric display [n]:
Timeout in seconds [3]:
Probe count [3]:
Minimum Time to Live [1]:
Maximum Time to Live [30]:
Port Number [33434]:
Loose, Strict, Record, Timestamp, Verbose[none]:
Type escape sequence to abort.
Tracing the route to 1.1.1.1
VRF info: (vrf in name/id, vrf out name/id)
  1 13.0.0.1 12 msec 12 msec 20 msec
  2 172.30.1.254 28 msec 32 msec 28 msec
  3 175.215.255.254 28 msec 28 msec 28 msec
  4 112.174.185.93 32 msec 28 msec 56 msec
  5  *  *  *
  6  *  *  *
  7  *  *  *
  8 218.145.42.210 28 msec *  *
  9 141.101.82.21 12 msec 20 msec 52 msec
 10 1.1.1.1 40 msec 28 msec 52 msec
LA-R1#
```

Some of these options are the same ones used by `ping` (Protocol, Target IP address, Source Address, Timeout in seconds, IP header options).

* **Numeric display**
	* Turns off a DNS lookup for the names of the routers and the destination
* **Time to Live**
	* Specifies how many hops the trace is allowed to take
* **Loose**
	* Tells the router that the hops you specify must appear in the trace path, but other routers can appear as well.
* **Strict**
	* Restricts the trace path only to those routers that you speicify
* **Record**
	* Specifies the number of hops to leave room for in the trace packet
* **Timestamp**
	* Enables you to specify the amount of space to leave room for in the trace packet for timing information
* **Verbose**
	* Automatically selected whenever you choose any of the options from this question; prints the entire contents of the trace packet

One important item to point out about the `traceroute` command is that if more than one path exist to reach the destination, this command will test *each* path, which cna take the trace process longer.
And like the extended `ping` command, instead of using the script to perform the test, you can enter the command and all of its parameters on a single command line.

### Layer 7 Connectivity Testing

The `ping` and `traceroute` commands can test only layer 3 connectivity.
If you can reach a destination with either of these two commands, this indicates that layer 3 and below are functioning correctly.

You can use other tools, such as telent, to test the application layer.
If you can telnet to a destination, then all seven layers of the model are functionaing correctly.
As an example, if you can telent to a machine but can't send an e-mail to it, the the problem is *not* a networking problem, but an appliction problem (with the e-mail program).
If you are filtering traffic with an access control list, this could also be the culprit.

### Debug Overview

One problem with using `show` commands is that they display only what is currently stored somewhere in the router's RAM, and this display is *static*.

You have to re-execute the command to get a refershed update.
And `show` commands, unfortunately, do not always display detailed troubleshooting information.
For example, perhaps you want the router to tell you when a particular event occurs and display some of the packet contents of that event. The `show` commands cannot do this; however, `debug` commands can.

One of the most powerful troubleshooting tools of IOS is the `debug` command, which enables you to view events and problems, in real time, on your Cisco device.

The `debug` commands, however, have a drawback: Since the router has to examine and display many different things when this feature is enabled, the performance of IOS will supper.

As an example, if you want to see every IP packet that travels through a router, the router has to examine each packet, determine whether it is an IP packet, and then display the packet or partial packet contents on the screen.
On a very busy router, this debug process can cause serious perfomace degradation.

Therefore, you should be very careful about enabling a debug process on your router; you may want to wait till after hours of periods of lesser activity before using this tool.

> You should never use the **`debug all`** command. this enables debugging for every process realated to IOS features enabled on your router.
> In this situcation, you'll see pages of output message on all kinds of things and, on a busy IOS device, probably crash it.

Typically, you will use `debug` commands for detaild troubleshooting.
For instance, you may have tried using `show` commands to discover the cause of a particular problem, but without any success.
You should then turn to using a particular `debug` command to uncover the source of the problem.

This command has many, many options and parameters. use context-sensitive help to view them.

To enable `debug`, you must be at privileged EXEC mode. If you are not on the console when enabling `debug`, you'll also need to execute the privileged EXEC `terminal monitor` command to see the `debug` output on your non-console line.

Once you've fixed your problem or no longer need to see the `debug` output, you should always disable the `debug` process.
You can disable it either by prefacing the `debug` command with the `no` parameter or executing one of the following two commands:

```
IOS# no debug all

or

IOS# undebug all
```

These two commands disable all running `debug` commands on your router.
You can first use the `show debug` command to see which events or process you have enabled.

If you want to see timestamps displayed in your debug output:

```
Rotuer(config)# service timestamps debug datetime mesc
```

the `datetime` parameter displays the current date and time, and the `msec` parameter displays an additional timing parameter: milliseconds.

### Exercise 8-6: Using the Router's Troubleshooting Tools

1.  Console into router VAN-R1 and use the show cdp neighbors command to see what neighboring devices are connected to VAN-R1. Record them here:

Device ID: LA-R1
Local Interface: Ser 1/0
Platform: 7206VXR
Capability: R B (Router, Source Router Bridge)
Remote Port: 

```
VAN-R1#show cdp neighbors
Capability Codes: R - Router, T - Trans Bridge, B - Source Route Bridge
                  S - Switch, H - Host, I - IGMP, r - Repeater, P - Phone,
                  D - Remote, C - CVTA, M - Two-port Mac Relay

Device ID        Local Intrfce     Holdtme    Capability  Platform  Port ID
LA-R1            Ser 1/0           142              R B   7206VXR   Ser 1/0
```

Note that you cannot see the IP address of the neighboring device.

2.  To see the IP address of the neighboring device with CDP, use the show cdp neighbors detail command. Record the information here:
Device ID: LA-R1
IP Address: 13.0.0.2
IOS Version: 15.3(3)XB12

```
VAN-R1#show cdp neighbors detail
-------------------------
Device ID: LA-R1
Entry address(es):
  IP address: 13.0.0.2
Platform: Cisco 7206VXR,  Capabilities: Router Source-Route-Bridge
Interface: Serial1/0,  Port ID (outgoing port): Serial1/0
Holdtime : 175 sec

Version :
Cisco IOS Software, 7200 Software (C7200-ADVENTERPRISEK9-M), Version 15.3(3)XB12, RELEASE SOFTWARE (fc2)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2013 by Cisco Systems, Inc.
Compiled Tue 19-Nov-13 04:39 by prod_rel_team

advertisement version: 2
Management address(es):
  IP address: 13.0.0.2
```

3.  Now that you know the IP address of the neighboring device, you could telnet into it and then discover other devices from that device (if telnet was configured and you had the password). This is how you can document the network topology using CDP.

```
### PASSWORD
LA-R1#config t
LA-R1(config)#line vty 0 15
LA-R1(config-line)#password telnetpass
LA-R1(config-line)#login

### connect to LA-R1 using telnet
VAN-R1#telnet 13.0.0.2
Trying 13.0.0.2 ... Open


Password required, but none set

[Connection to 13.0.0.2 closed by foreign host]
VAN-R1#telnet 13.0.0.2
Trying 13.0.0.2 ... Open


User Access Verification

Password:
LA-R1>

```

---

## Licensing Cisco Devices

Licensing Cisco ISR G2 router has beocme more hand more command across many of Cisco platforms; even Cisco's switches are starting to support licensing of features and use. Prior to Cisco IOS version 15 on Cisco routers, Cisco had up to 12 different image types  for a particular device model and software version.
To simplify this, Cisco now has only four image types:
* IP Base
* Data (MPLS and ATM)
* Unified Communications (VoIP and IP)
* Security (firewall, IPS, and VPNs)

You can use the `show license feature` command to view the technology package licenses and the feature licenses supported by your router.

Licensing is enforced starting with Cisco ISR G2 routers (1900, 2900, and 3900 series).
Licensing unlocks features in IOS code.
Licenses comes in two types:

* **Evaluation**
	* This license is a temporary license that is valid for a particular period of time.
* **Permanent**
	* This license is valid for the life of the product

Licenses are associated with two values from a Cisco ISR G2 router, referred to as a universal device identifier (UDI):

* Product ID (platform type)
* Serial number (located in ROM on the motherboard)

The importance of the UDI is that the license you obtain from Cisco is tied to this value.
In other words, you can't take a license from one router and copy it to another router: the license is tied to the UDI value of your Cisco ISR G2 router.

### Installing Licenses

To install a permanet license:
```
Router# license install URL_LOCATION
```

The license file is an XML file that you download from Cisco.
Typically you would place this in flash on the router, but you could pull it from a remote server via TFTP or FTP.

```
Router# license install flash0:uck9-c3900-SPE150_k9-FHH12250057.xml
```

Once you've installed a license, it is not used until the router is rebooted.
You can execute the `reload` command to reboot the router.

To activate an evaluation license:
```
Router(config)# license boot module MODULE_NAME technology-package PACKAGE_NAME
```

The `MODULE_NAME` is the product model, such as c3900 for a 3900 router.
The technology `PACAKGE_NAME` is one of the four packages.
For example, the security package parameter is `securityk9`.
As with a permanent license, you must reboot the router for the license to take effect.

### Licensing Verification

One of the first commands you can use to verify your licensing is the `show version` command.

You can also use the `show license` command to view the installed license.

### Managing Licenses

To back up a license, use the `license save` command

```
Router# license save URL
```

You can save the license file to the local file system or a remote server

```
license save flash:/licenses.lic
```

To uninstall (remove) a license from a router, you need to perform two actions:

1. Disable the technology package.
2. Clear the license

To disable the technology package, use the `license boot module` command.

```
Router(config)#license boot module c3900 technology-package uck9 disable
Router(config)#do copy running-config startup-config
Router(config)#do reload
```

Once the router has rebooted, you need to clear the license with the `license clear` command.

```
Router# license clear uck9
```

Once done, you can re-enable the technology package

---

## Chapter Review

Use the `copy` commands to manipulate files, including configuration files and IOS images.

Any time you copy something into RAM, IOS uses a merge process. For any other location, IOS uses an overwrite process.
One IOS devices, use the `erase startup-config` command to delete the startup-config file in NVRAM.

SSH should be used instead of telnet for remote terminal (CLI) access to the router since SSH encrypts traffic between your desktop and an IOS device.

CDP is a Cisco-proprieatry protocol that functions at the data link layer.
Every 60 seconds, a Cisco device generates a multicast on each of its interfaces, containing basic information about itself, including the device type, the version of software it's running, and its IP address(es).
To disalbe CDP globally, use the `no cdp run` command.
To see a list of your neighbors, use the `show cdp neighbors` command.

The `ping` and `traceroute` commands supports an extended version at privileged EXEC mode. If you want to suspend an active telnet session, use the `CTRL-SHIFT-6, x` control sequence.
Pressing Enter on a black command line resumes the last suspended telnet session.
Use the `resume` command to resume a telnet connection.
Use the `show sessions` command to see your open telnet session.
Use the `disconnect` command to disconnect a suspended telnet session.

To disable debug on your IOS device, use `undebug all` or `no debug all`.
Debugin functions only at privileged EXEC mode.

Licenses are of two types: evaluation and permanent.
To install a permanent license, use the `license install` command.
To verify the licensing on your router, use the `show version` and `show license` commands.

---

## Quick Review

### Router Configuration Files

* These commands perform a merge process
	* `copy startup-config running-config`
	* `copy tftp running-config`
	* `configure terminal`
	* write into RAM
* These commands perform an overwrite process
	* `copy running-config startup-config`
	* `copy running-config tftp`
* IOS devices do not automatically save their configuration in RAM
	* You must execute the `copy running-config startup-config` command to save the active configuration file to NVRAM.

### Changes in Your Network

* Always back up your configuration before making any changes to it.

### IOS Image Files

* When upgrading your IOS, make sure you downloaded the version of IOS from Cisco that contains the features that you purchased, and verify that your router has enough flash and RAM for the new image.
* Use the `copy tftp: flash:` command to copy the IOS image file from the TFTP server to the flash memory on your device.
* Use the `tftpdnld` command to download an IOS image file from the TFTP server when in ROMMON mode
* Use the `xmodem` command to copy the IOS iamge file from a computer to the Cisco device using the console cable when there are no networking capabilities.
* Use the `reload` command to reboot your router

### Remote Access to Your Cisco Device

* To telnet into a device, you must have VTY ports configured with passwords and there must be a password on privileged EXEC mode.
* Use SSH for an encrypted remote-access terminal session to your router.
	* Use the `transport input` command to limit what management protocols are allowed on the VTYs.

### Troubleshooting and Debugging

* For layer 2 troubleshooting, use the `show interfaces` command and `show cdp` command.
* For layer 3 troubleshooting, use `ping` and `traceroute`
* For layer 7 troubleshooting, use `telnet`
* For detailed troubleshooting, use `debug`.
* CDP is a Cisco proprietary protocol that is used to learn basic information about directly connected Cisco devices. It generates a multicast every 60 seconds and is enabled by default on Cisco devices.
* The *Link Layer Discovery Protocol (LLDP)* is an IEEE standard protocol used to discover devices on the network
* To execute an extended `ping` or `traceroute`, you must be at privileged EXEC mode.
	* The `ping` tests only if the destination is reachable
	* The `traceroute` lists each layer 3 device along the way to the destination.
* To suspend a telent session, use `CTRL-SHIFT-6, x`
* The `debug` commands require privileged EXEC access.
	* To disable all `debug` comands, use `no debug all` or `undebug all`

#### Licensing Cisco Devices

* Use the `license install` command to install a new license
	* Use the `show version` and `show licenses` command to view installed licenses


---

### Questions

1.  Which router commands perform an overwrite process? (Choose two.)

**A. copy running-config startup-config**
B. copy startup-config running-config: merge
C. copy tftp running-config: merge
**D. copy running-config tftp**

2.  Enter the router command to delete your configuration file in
NVRAM: `IOS#erase startup-config`

3.  You have executed the show startup-config command and see the
following message: 
```
%%Non-volatile configuration memory is not present.
```
 Which of the following answers are correct about these two things? (Choose two.)

A. This command displays the running configuration in NVRAM.
**B. This command displays the saved configuration in NVRAM.**
C. This command displays the saved configuration in flash.
D. The message indicates that flash needs to be reformatted.
E. This message indicates that NVRAM needs to be reformatted.
**F. This message indicates that there is nothing stored in this memory location.**

4.  When backing up your IOS image from flash, which of the following will the `copy flash tftp` command prompt you for? (Choose three.)

**A. TFTP server IP address** 
B. Verification to copy
**C. Source filename**
**D. Destination filename**

5.  What IOS command will display the version of software your device is running?

A. show startup-config
B. show flash
**C. show version**
D. dir and show version

6.  Enter the IOS configuration on the first five VTYs to allow only SSH access and to prompt for both a username and password for line authentication: 

```
IOS#config t
### set username and secret
IOS(config)#username myuser password mypass

### set hostname
IOS(config)#hostname R1

### configure ssh
R1(config)#ip ssh version 2
R1(config)#crypto key generate rsa

### vty configure
R1(config)#line vty 0 4
R1(config-line)#transport input ssh
R1(config-line)#login local
```

7.  Enter the IOS command that will create RSA public and private keys to encrypt and decrypt traffic for an SSH session: `IOS(config)#crypto key generate rsa`.

8.  Which of the following is true of CDP?

A. The show cdp neighbor command displays what version of software the neighbor is running.
B. The no cdp run command disables CDP on an interface.
C. CDP sends out broadcasts every 60 seconds.
**D. CDP can be used to validate layer 2 connectivity.**

9.  Which router command would you use to test only layer 3 connectivity?

A. telnet: layer 7
B. show cdp traffic
C. show interfaces
**D. traceroute**

10.  How would you suspend a telnet session?

A. ctrl-shift-x, 6
**B. ctrl-shift-6, x**
C. ctrl-alt-ins
D. ctrl-c

11.  What IOS command is used to verify the installed licenses on a Cisco router?

A. show installed-licenses
B. show flash:licenses
C. license view
**D. show version** and, `show licenses`

12.  What command was used to generate the following output?

```
Capability Codes: R - Router, T - Trans Bridge, B - Source Route Bridge
                  S - Switch, H - Host, I - IGMP, r - Repeater, P - Phone, 
                  D - Remote, C - CVTA, M - Two-port Mac Relay 

Device ID        Local Intrfce     Holdtme    Capability  Platform  Port ID
LA-R1            Ser 1/0           139              R B   7206VXR   Ser 1/0
```

A. Show cdp neighbor detail
B. Show interfaces
**C. show cdp neighbor**
D. show ip interface brief

13.  What command was used to generate the following output?

```
-------------------------
Device ID: LA-R1
Entry address(es):
  IP address: 13.0.0.2
Platform: Cisco 7206VXR,  Capabilities: Router Source-Route-Bridge
Interface: Serial1/0,  Port ID (outgoing port): Serial1/0
Holdtime : 159 sec

Version :
Cisco IOS Software, 7200 Software (C7200-ADVENTERPRISEK9-M), Version 15.3(3)XB12, RELEASE SOFTWARE (fc2)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2013 by Cisco Systems, Inc.
Compiled Tue 19-Nov-13 04:39 by prod_rel_team

advertisement version: 2
Management address(es):
  IP address: 13.0.0.2
```

**A. Show cdp neighbor detail**
B. Show interfaces
C. show cdp neighbor
D. show ip interface brief

14.  As the network administrator for your company you need to create a network diagram containing all of the network devices that include Cisco devices, Juniper devices, and devices from other vendors. What command would you use on your Cisco devices?

A. cdp run: cisco proprietary
**B. lldp run**
C. show cdp neighbor
D. cdp enable
### Performance-based Questions

1.  You have configured an extended access list with the following rules:

```
access-list 120 deny tcp 145.13.45.100 0.0.7.255 any eq 23
access-list 120 deny tcp 145.13.45.100 0.0.7.255 any eq http
access-list 120 permit ip any any
```

Using the following exhibit, identify which packets would be denied and which packets would be permitted by writing the packet information in the boxes on the right.

![[Pasted image 20251013173838.png]]

* TFTP
	* Port 69
	* Authentication not supported
	* UDP based
* FTP
	* TCP based
	* Ports 21 and 20
	* Supports authentication


2.  Draw a line from the command on the left side to the appropriate description on the right side. Not all descriptions are used.

![[Pasted image 20251013173852.png]]

* `copy running-config startup-config`
	* Save current changes to NVRAM
* `copy running-config tftp`
	* Back up current config to a server
* `copy tftp running-config`
	* Restore a configuration to the device
* `copy tftp flash`
	* Restore the IOS to the device
* `copy flash tftp`
	* Backup the IOS to a server
